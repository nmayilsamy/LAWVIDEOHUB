<!DOCTYPE html>
<html>
<head>
  <title>Category</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }
    h2 {
      margin-bottom: 20px;
    }
    iframe {
      width: 100%;
      height: 400px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 id="categoryHeading"></h2>
    <div id="youtubePlayer"></div>
  </div>

  <script>
    function fetchCSVFile(fileUrl, callback) {
      fetch(fileUrl)
        .then(response => response.text())
        .then(csvData => {
          callback(csvData);
        })
        .catch(error => {
          console.error("Error reading CSV file:", error);
        });
    }

    function parseCSVData(csvData) {
      const csvRows = csvData.split("\n");
      const categories = [];

      for (let i = 1; i < csvRows.length; i++) {
        const rowData = csvRows[i].split(",");
        if (rowData.length > 0) {
          const category = rowData[0].trim();
          const youtubeLink = rowData[1].trim();
          categories.push({ category, youtubeLink });
        }
      }

      return categories;
    }

    function getCategoryFromParams() {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get("category");
    }

    function displayCategory(category, youtubeLink) {
      const categoryHeading = document.getElementById("categoryHeading");
      categoryHeading.textContent = category;

      const youtubePlayer = document.getElementById("youtubePlayer");
      youtubePlayer.innerHTML = `
        <iframe
          width="560"
          height="315"
          src="https://www.youtube.com/embed/${youtubeLink}"
          frameborder="0"
          allowfullscreen
        ></iframe>
      `;
    }

    const csvFileUrl = "../categories.csv";

    fetchCSVFile(csvFileUrl, function(csvData) {
      const categories = parseCSVData(csvData);
      const categoryParam = getCategoryFromParams();
      const filteredCategory = categories.find(
        category => category.category === categoryParam
      );

      if (filteredCategory) {
        displayCategory(
          filteredCategory.category,
          filteredCategory.youtubeLink
        );
      } else {
        console.error("Category not found");
      }
    });
  </script>
</body>
</html>
